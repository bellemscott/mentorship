<!DOCTYPE html>
<html>
<head>
    <title>Mentorship App</title>
    <meta charset="utf-8">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
    <%= render 'layouts/header' %>
    <h1>Explore</h1>
    <div class= "center jumbotron" style="background:white" >
    <% if @user.mentee? %>
        <% @mentee_id = Mentee.find_by(user_id: @user.id).id %>
        <% users = @mentor_matches %> 
        <% role = "mentor"%>
    <% elsif @user.mentor? %>
        <% @mentor_id = Mentor.find_by(user_id: @user.id).id %>
        <% users = @mentee_matches%> 
        <% role = "mentee"%>
    <% end %>

    <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="false" >
            <!-- Indicators -->
        <ol class="carousel-indicators">
            <% users.each_with_index do |possible_match, i| %>
            <li data-target="#mycarousel" data-slide-to=#{i) class="#{'active' if i == 0}"></li>
            <% end %>
        </ol>

        <!-- Wrapper for slides -->
        <div class="carousel-inner" role="listbox">
            <% users.each_with_index do |possible_match, i| %>
            <% possible_user = User.find(possible_match.user_id) %>
                <div class="item <%= "active " if i==0 %>">
                    <div>
                        <% if possible_match.avatar.attached? %>
                            <img class="d-block w-100" src="<%=(url_for(possible_match.avatar))%>" width="220" height="200">
                        <% else %>
                            <img class="d-block w-100" src="https://www.pngitem.com/pimgs/m/30-307416_profile-icon-png-image-free-download-searchpng-employee.png" width="220" height="200"/>
                        <% end %>
                        <br>
                        <br>
                        <p><%= possible_user.firstname + " " + possible_user.lastname %></p>
                        <p><%= possible_user.email %></p>
                        <% if role == "mentor" %>
                            <table class= "table center" style="width:500px; margin-left:auto;margin-right:auto;">
                                    <tr>
                                    <th>Area of expertise</th>
                                    <td><%= possible_match.area_of_expertise %></td>
                                    </tr>
                                    <tr>
                                    <th>Preferred method of contact</th>
                                    <td><%= possible_match.preferred_method_of_contact%></td>
                                    </tr>
                                    <tr>
                                    <th>University</th>
                                    <td><%= possible_match.school %></td>
                                    </tr>
                                    <tr>
                                    <th>Current position</th>
                                    <td><%= possible_match.current_position %></td>
                                    </tr>
                                    </tr>
                                    <th>Location</th>
                                    <td><%= possible_match.location %></td>
                                    <tr>
                                    </tr>
                                    <th>Preferred Length of Mentorship</th>
                                    <td><%= possible_match.length_of_mentorship %></td>
                                    <tr>
                                    <th colspan="20"></th>
                                    </tr>
                                </table>
                        <% else %>
                            <table class= "table center" style="width:500px; margin-left:auto;margin-right:auto;">
                                    <tr>
                                    <th>Major</th>
                                    <td><%= possible_match.major %></td>
                                    </tr>
                                    <tr>
                                    <th>Areas of Interest</th>
                                    <td><%= possible_match.area_of_interest%></td>
                                    </tr>
                                    <tr>
                                    <th>Location</th>
                                    <td><%= possible_match.location %></td>
                                    </tr>
                                    <tr>
                                    <th>Graduation Year</th>
                                    <td><%= possible_match.graduation_year %></td>
                                    </tr>
                                    </tr>
                                    <th>preferred Method of Contact</th>
                                    <td><%= possible_match.preferred_method_of_contact %></td>
                                    <tr>
                                    </tr>
                                    <th>preferred Length of Mentorship</th>
                                    <td><%= possible_match.length_of_mentorship %></td>
                                    <tr>
                                    <th colspan="20"></th>
                                    </tr>
                                </table>
                        <% end %>
                        <% if role == "mentee" %>
                            <% @match = Match.find_by(user_id: 125, mentor_id: 9, mentor_id: 55) %>
                        <% else %>
                            <% @match = Match.find_by(user_id: current_user.id, mentee_id: possible_match.id, mentor_id: @mentor_id) %>
                        <% end %>
                        <%= form_tag welcome_update_path, method: :patch do %>
                            <%if @user.mentee? %> <% @match = Match.find_by(user_id: current_user.id, mentor_id: possible_match.id, mentee_id: @mentee_id)%>
                            <% end %>
                            <%if @user.mentor? %><% @match = Match.find_by(user_id: current_user.id, mentor_id: @mentor_id, mentee_id: possible_match.id) %>
                            <%end%>
                            <% puts @match %>
                            <% puts "match was found "%>
                            <%= hidden_field_tag :match_id, @match.id %>
                            <%= submit_tag 'Accept Match?' %>
                        <% end %>

                    </div>
                </div>
            <% end %>
        </div>
        <a class="left carousel-control" href="#myCarousel" data-slide="prev">
            <span class="icon-prev"></span>
        </a>
        <a class="right carousel-control" href="#myCarousel" data-slide="next">
            <span class="icon-next"></span>
        </a>
    </div>
    </div>

</body>
</html> 